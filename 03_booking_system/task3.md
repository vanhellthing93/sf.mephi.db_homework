# Задача 3
## Условие

Вам необходимо провести анализ данных о бронированиях в отелях и определить предпочтения клиентов по типу отелей. Для этого выполните следующие шаги:

1. Категоризация отелей.
Определите категорию каждого отеля на основе средней стоимости номера:

    - «Дешевый»: средняя стоимость менее 175 долларов.
    - «Средний»: средняя стоимость от 175 до 300 долларов.
    - «Дорогой»: средняя стоимость более 300 долларов.

2. Анализ предпочтений клиентов.
Для каждого клиента определите предпочитаемый тип отеля на основании условия ниже:

    - Если у клиента есть хотя бы один «дорогой» отель, присвойте ему категорию «дорогой».
    - Если у клиента нет «дорогих» отелей, но есть хотя бы один «средний», присвойте ему категорию «средний».
    - Если у клиента нет «дорогих» и «средних» отелей, но есть «дешевые», присвойте ему категорию предпочитаемых отелей «дешевый».

3. Вывод информации.
Выведите для каждого клиента следующую информацию:

    - ID_customer: уникальный идентификатор клиента.
    - name: имя клиента.
    - preferred_hotel_type: предпочитаемый тип отеля.
    - visited_hotels: список уникальных отелей, которые посетил клиент.

4. Сортировка результатов.
Отсортируйте клиентов так, чтобы сначала шли клиенты с «дешевыми» отелями, затем со «средними» и в конце — с «дорогими».

```
Решение задачи должно представлять из себя один SQL-запрос.
```

## Критерии оценивания

Задача решена верно: 6 баллов.

Задача частично решена верно: 3 балла.

Задача решена неверно: 0 баллов.

## Ожидаемый вывод для тестовых данных

|ID_customer|	name|	preferred_hotel_type|	visited_hotels|
|-|-|-|-|
|10|	Hanna Montana|	Дешевый|	City Center Inn|
|1|	John Doe|	Средний|	City Center Inn,Grand Hotel|
|2|	Jane Smith|	Средний|	Grand Hotel|
|3|	Alice Johnson|	Средний|	Grand Hotel|
|4|	Bob Brown|	Средний|	Grand Hotel,Ocean View Resort|
|5|	Charlie White|	Средний|	Ocean View Resort|
|6|	Diana Prince|	Средний|	Ocean View Resort|
|7|	Ethan Hunt|	Дорогой|	Mountain Retreat,Ocean View Resort|
|8|	Fiona Apple|	Дорогой|	Mountain Retreat|
|9|	George Washington|	Дорогой|	City Center Inn,Mountain Retreat|